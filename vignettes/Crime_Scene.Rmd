---
title: "Crime_Scene"
author: "Peiyuan Zhu"
date: "2023-10-13"
output: rmarkdown::html_vignette
# output: word_document
vignette: >
  %\VignetteIndexEntry{Crime_Scene}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
library(dst) 
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This is an example taken from Geometry of Uncertainty by Fabio Cuzzolin (2021). Suppose we're a detector investigating the crime scene. There are two witnesses that witnessed a murder. Three suspects are called into question: Mary, Peter, and John. Mary and John are blonde. From the first witness's testimony, the suspect was a male. However, as a detective we're don't trust the witness, because the witness was drunk that day and cannot be completely accountable for his testimony. Another witness found a blond hair on the floor, but the floor might have been cleaned before the crime scene was controlled.

## Belief combination

Now let's put the above example in the language of evidential theory. We start by conceptualizing a frame of discernment $\Theta=\{\text{Peter}, \text{John}, \text{Mary}\}$ for the outcome of the murder trial. Here we use the word "frame of discernment" to distinguish it from "sample space" in probability theory. Then we define basic chance assignment as $2^\Theta\rightarrow[0,1]$

There are two basic chance assignment objects created from the two witnesses. The first basic chance assignment assigns 0.8 to $\{\text{Peter}, \text{John}\}$ and 0.2 to $\Theta$. This means that the detective imagine that out of all possible situations that could've happened, 80% of the situations happened such that the witness was not drunk, and out of all possible situations that could've happened, 20% of the situations happened such that the witness was drunk.

```{r}
bpa1 <- bca(matrix(c(1,1,0,1,1,1), nrow = 2, byrow = TRUE), c(0.8, 0.2), c("Peter", "John", "Mary"))
bpa1$tt
bpa1$spec
```

Number 0.8 is given out of a subjective judgement by the observer, which seems like it come from nowhere but the philosophy of the evidential theory is founded upon the view that value judgements e.g. a vote, as relational properties between a system and an observer at the metaphysical level, are as real as (or even more real as) atoms from the traditional, substance-based metaphysical level. In evidential theory, the relation is modelled as an uncertain relation, that is, a mathematical relation between a probability algebra and a frame of discernment.

With the basic chance assignment object, we can calculate the belplau object, which includes five parameters: belief, disbelief, unkown, plausibility, plausibility ratio of the outcomes. Here we use the word "belief" instead of "probability" to distinguish it from lower confidence interval containing objective probabilities from frequentist hypothesis testing, disbelief instead of "upper confidence interval" containing objective probabilities, and "unkown" to distinguish it from length of confidence interval of objective probabilities.

(1) The belief of a hypothesis is justified via summing over basic chance assignments that implies that hypothesis.
(2) The disbelief of a hypothesis is justified via summing over basic chance assignments that implies the negation of that hypothesis.
(3) The epistemic uncertainty is calculated via the remaining masses that are neither attributed to belief, nor attributed to disbelief.
(4) The plausibility is calculated via the remaining masses that are not attributed to disbelief.
(5) The plausibility ratio is calculated via the ratio between the remaining masses that are not attributed to disbelief and the remaining masses that are not attributed to belief.

```{r}
belplau1<-belplau(bpa1)
belplau1
```

Notice since both belief and basic mass assignment take the same values as both are defined via the summation operation. No belief on any suspect more specific than the entire group, can solemnly justify the entire crime scene. The second chance assignment assigns 0.6 to $\{\text{Peter}, \text{John}\}$ and 0.4 to $\Theta$ following the same logic as the first basic chance assignment. The basic chance assignment object can be created likewise.

```{r}
bpa2 <- bca(matrix(c(0,1,1,1,1,1), nrow = 2, byrow = TRUE), c(0.6, 0.4), c("Peter", "John", "Mary"))
bpa2$tt
bpa2$spec
```

The belplau object can be obtained from the basic chance assignment object by following the same logic as how the first belplau object is created via the first basic chance assignment object.

```{r}
belplau2<-belplau(bpa2)
belplau2
```

Having obtained two basic chance assignment objects, we can use dsrwon to combine them and obtain a new basic chance assignment object. We cannot combine belplau objects as it is known that there's no close form solution to the combined result in general. Here we use the word "combination" to distinguish it from constructing probability measure on the product space, usually done via Kolmogorov extension theorem among the frequentist methods, or random measure from de Finetti theorem among the Bayesian methods.

```{r}
bpa3<-dsrwon(bpa1, bpa2)
bpa3$tt
bpa3$spec
```

The belplau object can be obtained from the basic chance assignment object by following the same logic as how the first belplau object is created via the first basic chance assignment object. Notice the belief on the new set of intersection is multiplied while the belief of the existing two evidences stays put.

```{r}
belplau3<-belplau(bpa3)
belplau3
```
